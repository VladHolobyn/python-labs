{% extends "base.html" %}
{% from "_render-field.html" import render_field %}
{% block title %}Posts{% endblock %}
{% block content %}
<div class="container py-5 h-100">
  <div class="d-flex justify-content-end mb-2" style="gap: 10px;">
    <a href="{{url_for('posts.add_post')}}" class="btn btn-success" style="padding: 5px 25px;">New</a>
  </div>
  {% for post in posts %}
    {% if post.enabled or post.user.id == current_user.id %}
      <div class="card mb-5">
        <div class="card-body">
          <div class="row">
            {% if post.image %}
              <div class="col-6">
                  <img class="post-image" src="{{url_for('posts.static', filename='posts_image/' + post.image)}}" alt="">
              </div>
            {% endif %}
            <div class="col d-flex flex-column">
              <div class="d-flex justify-content-between align-items-center">
                <h2 class="card-title">{{ post.title }}</h2>
                {% if post.type.name == "low" %}
                  <span class="badge rounded-pill bg-success">{{ post.type.name }}</span>
                {% elif post.type.name == "medium" %}
                  <span class="badge rounded-pill bg-warning">{{ post.type.name }}</span>
                {% else %}
                  <span class="badge rounded-pill bg-danger">{{ post.type.name }}</span>
                {% endif %}
              </div>
              
              <h6 class="card-subtitle mb-2 text-muted">{{ post.user.email }}</h6>

              <p class="card-text flex-1  mt-3">{{ post.text }}</p>

              <div class="d-flex justify-content-between align-items-center">
                <a href="{{url_for('posts.post_page', id=post.id)}}" class="btn btn-outline-dark" style="padding: 5px 25px;">Read</a>
                <p class="text-body-tertiary mb-0">
                  {{ post.created.strftime('%Y-%m-%d %H:%M:%S') }}
                  {% if not post.enabled %}
                    (disabled)
                  {% endif%}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endif %}

  {% endfor %}
</div>
{% endblock %}
